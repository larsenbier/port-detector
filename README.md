# port-detector
Progress made towards implementing a vision-based model for detecting empty and connected ports on server racks.

# File Info
* Note that all of these notebooks were originally written in Kaggle, so file references in the code refer to files in the `/kaggle/input` directory or the `/kaggle/working` directory.

## `port-dataset-for-classificiation.ipynb`
* Notebook used to transform the original dataset, which was in COCO json format, into a usable format.
* The generated dataset is used for classification, not object detection like the original dataset.
* The classification images were generated by taking sub-images of the original dataset (which was labeled with boxes identifying empty and connected ports).
* The output is generated as a zip file if run through kaggle.
* More details can be found in the notebook.
* [Kaggle Link](https://www.kaggle.com/code/larsenbier/port-dataset-for-classification)

## `port-classifier.ipynb`
* This is the notebook used to train the image classifier used in the sliding window method of the `port-detector.ipynb`.
* The model chosen was a modified version of ResNet18 with 3 output classes.
* Other implementation details can be found in the notebook.
* [Kaggle Link](https://www.kaggle.com/code/larsenbier/port-classifier)

## `port-detector.ipynb`
* Notebook used to run the sliding window object detection method with the classifier from `port-classifier.ipynb`.
* The results of the sliding window method did not match the good performance of the classifier. A starting point for future investigation could be to find out why it does not match. My best guess is that the dataset I made in `port-dataset-for-classification.ipynb` is not selecting sample images that help the classifier on full-scale object detection. The model itself should be just fine, considering that it achieved good performance on every dataset I used.
  * Note that when using the current weights for the classifier, the model identifies only background objects. This might seem like an artefact of the sliding window method, but previous versions of the classifier that used different weights were able to identify empty and connected ports.
* [Kaggle Link](https://www.kaggle.com/code/larsenbier/port-detector)

## `best_weights.pth`
* Weights of the most recently trained classifier (trained by `port-classifier.ipynb`).
* Make sure that if you are loading in weights, you load them in to the same architecture as I used for training.
